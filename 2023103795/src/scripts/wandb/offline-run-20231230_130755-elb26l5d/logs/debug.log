2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Current SDK version is 0.15.10
2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Configure stats pid to 2577468
2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Loading settings from /data2/dy/code/unmasked_teacher/multi_modality/wandb/settings
2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'multi_modality/tasks/retrieval.py', 'program': '/data2/dy/code/unmasked_teacher/multi_modality/tasks/retrieval.py'}
2023-12-30 13:07:55,139 INFO    MainThread:2577468 [wandb_setup.py:_flush():76] Applying login settings: {'mode': 'offline'}
2023-12-30 13:07:55,140 INFO    MainThread:2577468 [wandb_init.py:_log_setup():524] Logging user logs to /data2/dy/code/unmasked_teacher/multi_modality/wandb/offline-run-20231230_130755-elb26l5d/logs/debug.log
2023-12-30 13:07:55,140 INFO    MainThread:2577468 [wandb_init.py:_log_setup():525] Logging internal logs to /data2/dy/code/unmasked_teacher/multi_modality/wandb/offline-run-20231230_130755-elb26l5d/logs/debug-internal.log
2023-12-30 13:07:55,140 INFO    MainThread:2577468 [wandb_init.py:init():564] calling init triggers
2023-12-30 13:07:55,140 INFO    MainThread:2577468 [wandb_init.py:init():571] wandb.init called with sweep_config: {}
config: {'data_dir': '/data2/dy/code/unmasked_teacher/umt_data', 'data_root': '/data2/dy/code/unmasked_teacher/umt_data/videos_images', 'anno_root_pt': '/data2/dy/code/unmasked_teacher/umt_data/anno_pretrain', 'anno_root_downstream': '/data2/dy/code/unmasked_teacher/umt_data/anno_downstream', 'TextEncoders': {'bert': {'name': 'bert_base', 'pretrained': 'bert-base-uncased', 'config': 'configs/config_bert.json', 'd_model': 768, 'fusion_layer': 9}, 'bert_large': {'name': 'bert_large', 'pretrained': 'bert-large-uncased', 'config': 'configs/config_bert_large.json', 'd_model': 1024, 'fusion_layer': 19}}, 'your_ssv2_path': '/datassd2/DATASET/something-something-v2/rawvideo/20bn-something-something-v2', 'train_file': ['/data2/dy/code/unmasked_teacher/umt_data/anno_downstream/ssv2_ret_label_train.json', '/datassd2/DATASET/something-something-v2/rawvideo/20bn-something-something-v2', 'video'], 'test_file': {'val': ['/data2/dy/code/unmasked_teacher/umt_data/anno_downstream/ssv2_ret_label_val_small.json', '/datassd2/DATASET/something-something-v2/rawvideo/20bn-something-something-v2', 'video']}, 'test_types': ['val'], 'num_workers': 6, 'stop_key': 'val/', 'is_paragraph_retrieval': False, 'has_multi_vision_gt': True, 'num_frames': 12, 'num_frames_test': 12, 'batch_size': 32, 'max_txt_l': 25, 'inputs': {'image_res': 224, 'video_input': {'num_frames': 12, 'sample_type': 'rand', 'num_frames_test': 12, 'sample_type_test': 'middle', 'random_aug': False}, 'max_txt_l': {'image': 25, 'video': 25}, 'batch_size': {'image': 32, 'video': 32}, 'batch_size_test': {'image': 32, 'video': 32}}, 'text_enc': 'bert', 'model': {'model_cls': 'UMT', 'vision_encoder': {'name': 'vit_b16', 'img_size': 224, 'patch_size': 16, 'd_model': 768, 'encoder_embed_dim': 768, 'encoder_depth': 12, 'encoder_num_heads': 12, 'drop_path_rate': 0.1, 'num_frames': 12, 'tubelet_size': 1, 'use_checkpoint': True, 'checkpoint_num': 12, 'clip_decoder_embed_dim': 768, 'clip_output_dim': 512, 'clip_return_layer': 0, 'clip_student_return_interval': 1, 'pretrained': '/datassd2/pretrained_model/Unmasked_Teacher/b16_ptk710_f8_res224.pth', 'clip_teacher': 'none', 'clip_img_size': 224, 'clip_return_interval': 1, 'video_mask_type': 'attention', 'video_mask_ratio': 0.0, 'video_double_mask_ratio': 0.0, 'image_mask_type': 'attention', 'image_mask_ratio': 0.0, 'image_double_mask_ratio': 0.0, 'keep_temporal': True}, 'text_encoder': {'name': 'bert_base', 'pretrained': 'bert-base-uncased', 'config': 'configs/config_bert.json', 'd_model': 768, 'fusion_layer': 9}, 'multimodal': {'enable': True}, 'embed_dim': 512, 'temp': 0.07}, 'criterion': {'loss_weight': {'vtc': 1.0, 'mlm': 0.0, 'vtm': 1.0, 'uta': 0.0}, 'vtm_hard_neg': True, 'mlm_masking_prob': 0.5, 'uta_norm_type': 'l2', 'uta_loss_type': 'l2'}, 'optimizer': {'opt': 'adamW', 'lr': 5e-05, 'opt_betas': [0.9, 0.999], 'weight_decay': 0.02, 'max_grad_norm': -1, 'different_lr': {'enable': False, 'module_names': [], 'lr': 0.001}}, 'scheduler': {'sched': 'cosine', 'epochs': 10, 'min_lr_multi': 0.01, 'warmup_epochs': 0}, 'evaluate': False, 'deep_fusion': False, 'evaluation': {'eval_frame_ensemble': 'concat', 'eval_x_only': False, 'k_test': 128, 'eval_offload': True}, 'fp16': True, 'gradient_checkpointing': True, 'wandb': {'enable': True, 'entity': 'user', 'project': 'umt_ret_ssv2'}, 'dist_url': 'env://', 'device': 'cuda', 'mode': 'pt', 'output_dir': 'exp/finetuning/ret_ssv2_label/b16_5m', 'resume': False, 'debug': False, 'log_freq': 100, 'seed': 42, 'save_latest': True, 'auto_resume': True, 'pretrained_path': '/datassd2/pretrained_model/Unmasked_Teacher/multimodality/b16_5m.pth', 'rank': 0, 'world_size': 1, 'gpu': 0, 'distributed': True, 'dist_backend': 'nccl'}
2023-12-30 13:07:55,140 INFO    MainThread:2577468 [wandb_init.py:init():614] starting backend
2023-12-30 13:07:55,140 INFO    MainThread:2577468 [wandb_init.py:init():618] setting up manager
2023-12-30 13:07:55,149 INFO    MainThread:2577468 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-12-30 13:07:55,152 INFO    MainThread:2577468 [wandb_init.py:init():624] backend started and connected
2023-12-30 13:07:55,163 INFO    MainThread:2577468 [wandb_init.py:init():715] updated telemetry
2023-12-30 13:07:55,169 INFO    MainThread:2577468 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2023-12-30 13:07:55,177 INFO    MainThread:2577468 [wandb_init.py:init():799] starting run threads in backend
2023-12-30 13:08:01,062 INFO    MainThread:2577468 [wandb_run.py:_console_start():2199] atexit reg
2023-12-30 13:08:01,063 INFO    MainThread:2577468 [wandb_run.py:_redirect():2054] redirect: wrap_raw
2023-12-30 13:08:01,063 INFO    MainThread:2577468 [wandb_run.py:_redirect():2119] Wrapping output streams.
2023-12-30 13:08:01,063 INFO    MainThread:2577468 [wandb_run.py:_redirect():2144] Redirects installed.
2023-12-30 13:08:01,065 INFO    MainThread:2577468 [wandb_init.py:init():840] run started, returning control to user process
2023-12-30 13:08:04,294 WARNING MsgRouterThr:2577468 [router.py:message_loop():77] message_loop has been closed
