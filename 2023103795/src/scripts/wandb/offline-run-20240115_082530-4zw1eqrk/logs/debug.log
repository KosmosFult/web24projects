2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Current SDK version is 0.15.10
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Configure stats pid to 391554
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Loading settings from /data2/dy/code/unmasked_teacher/multi_modality/wandb/settings
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'multi_modality/tasks/retrieval.py', 'program': '/data2/dy/code/unmasked_teacher/multi_modality/tasks/retrieval.py'}
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_setup.py:_flush():76] Applying login settings: {'mode': 'offline'}
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_init.py:_log_setup():524] Logging user logs to /data2/dy/code/unmasked_teacher/multi_modality/wandb/offline-run-20240115_082530-4zw1eqrk/logs/debug.log
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_init.py:_log_setup():525] Logging internal logs to /data2/dy/code/unmasked_teacher/multi_modality/wandb/offline-run-20240115_082530-4zw1eqrk/logs/debug-internal.log
2024-01-15 08:25:30,033 INFO    MainThread:391554 [wandb_init.py:init():564] calling init triggers
2024-01-15 08:25:30,034 INFO    MainThread:391554 [wandb_init.py:init():571] wandb.init called with sweep_config: {}
config: {'data_dir': '/data2/dy/code/unmasked_teacher/umt_data', 'data_root': '/data2/dy/code/unmasked_teacher/umt_data/videos_images', 'anno_root_pt': '/data2/dy/code/unmasked_teacher/umt_data/anno_pretrain', 'anno_root_downstream': '/data2/dy/code/unmasked_teacher/umt_data/anno_downstream', 'TextEncoders': {'bert': {'name': 'bert_base', 'pretrained': 'bert-base-uncased', 'config': 'configs/config_bert.json', 'd_model': 768, 'fusion_layer': 9}, 'bert_large': {'name': 'bert_large', 'pretrained': 'bert-large-uncased', 'config': 'configs/config_bert_large.json', 'd_model': 1024, 'fusion_layer': 19}}, 'train_file': ['/data2/dy/code/unmasked_teacher/umt_data/anno_downstream/msrvtt_ret_train9k.json', '/data1/DATASET/MSRVTT/videos', 'video'], 'test_file': {'test': ['/data2/dy/code/unmasked_teacher/umt_data/anno_downstream/msrvtt_ret_test1k.json', '/data1/DATASET/MSRVTT/videos', 'video']}, 'test_types': ['test'], 'num_workers': 6, 'stop_key': 'test/', 'is_paragraph_retrieval': False, 'num_frames': 1, 'num_frames_test': 1, 'batch_size': 64, 'max_txt_l': 32, 'inputs': {'image_res': 224, 'video_input': {'num_frames': 1, 'sample_type': 'rand', 'num_frames_test': 1, 'sample_type_test': 'middle', 'random_aug': False}, 'max_txt_l': {'image': 32, 'video': 32}, 'batch_size': {'image': 64, 'video': 64}, 'batch_size_test': {'image': 64, 'video': 64}}, 'text_enc': 'bert', 'model': {'model_cls': 'UMT', 'vision_encoder': {'name': 'vit_b16', 'img_size': 224, 'patch_size': 16, 'd_model': 768, 'encoder_embed_dim': 768, 'encoder_depth': 12, 'encoder_num_heads': 12, 'drop_path_rate': 0.2, 'num_frames': 1, 'tubelet_size': 1, 'use_checkpoint': True, 'checkpoint_num': 12, 'clip_decoder_embed_dim': 768, 'clip_output_dim': 512, 'clip_return_layer': 0, 'clip_student_return_interval': 1, 'pretrained': '/datassd2/pretrained_models/Unmasked_Teacher/b16_ptk710_f8_res224.pth', 'clip_teacher': 'none', 'clip_img_size': 224, 'clip_return_interval': 1, 'video_mask_type': 'attention', 'video_mask_ratio': 0.0, 'video_double_mask_ratio': 0.0, 'image_mask_type': 'attention', 'image_mask_ratio': 0.0, 'image_double_mask_ratio': 0.0, 'keep_temporal': True}, 'text_encoder': {'name': 'bert_base', 'pretrained': 'bert-base-uncased', 'config': 'configs/config_bert.json', 'd_model': 768, 'fusion_layer': 9}, 'multimodal': {'enable': True}, 'embed_dim': 512, 'temp': 0.07}, 'criterion': {'loss_weight': {'vtc': 1.0, 'mlm': 0.0, 'vtm': 1.0, 'uta': 0.0}, 'vtm_hard_neg': True, 'mlm_masking_prob': 0.5, 'uta_norm_type': 'l2', 'uta_loss_type': 'l2'}, 'optimizer': {'opt': 'adamW', 'lr': 1e-05, 'opt_betas': [0.9, 0.999], 'weight_decay': 0.02, 'max_grad_norm': -1, 'different_lr': {'enable': False, 'module_names': [], 'lr': 0.001}}, 'scheduler': {'sched': 'cosine', 'epochs': 5, 'min_lr_multi': 0.01, 'warmup_epochs': 1}, 'evaluate': False, 'deep_fusion': False, 'evaluation': {'eval_frame_ensemble': 'concat', 'eval_x_only': False, 'k_test': 128, 'eval_offload': True}, 'fp16': True, 'gradient_checkpointing': True, 'wandb': {'enable': True, 'entity': 'user', 'project': 'umt_ret'}, 'dist_url': 'env://', 'device': 'cuda', 'mode': 'pt', 'output_dir': 'exp/finetuning/ret_msrvtt/msrvtt_1frame_256', 'resume': False, 'debug': False, 'log_freq': 100, 'seed': 42, 'save_latest': True, 'auto_resume': True, 'pretrained_path': '/datassd2/pretrained_models/Unmasked_Teacher/multimodality/b16_25m.pth', 'rank': 0, 'world_size': 4, 'gpu': 0, 'distributed': True, 'dist_backend': 'nccl'}
2024-01-15 08:25:30,034 INFO    MainThread:391554 [wandb_init.py:init():614] starting backend
2024-01-15 08:25:30,034 INFO    MainThread:391554 [wandb_init.py:init():618] setting up manager
2024-01-15 08:25:30,038 INFO    MainThread:391554 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-01-15 08:25:30,048 INFO    MainThread:391554 [wandb_init.py:init():624] backend started and connected
2024-01-15 08:25:30,059 INFO    MainThread:391554 [wandb_init.py:init():715] updated telemetry
2024-01-15 08:25:30,065 INFO    MainThread:391554 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-01-15 08:25:30,073 INFO    MainThread:391554 [wandb_init.py:init():799] starting run threads in backend
2024-01-15 08:25:35,628 INFO    MainThread:391554 [wandb_run.py:_console_start():2199] atexit reg
2024-01-15 08:25:35,628 INFO    MainThread:391554 [wandb_run.py:_redirect():2054] redirect: wrap_raw
2024-01-15 08:25:35,628 INFO    MainThread:391554 [wandb_run.py:_redirect():2119] Wrapping output streams.
2024-01-15 08:25:35,629 INFO    MainThread:391554 [wandb_run.py:_redirect():2144] Redirects installed.
2024-01-15 08:25:35,630 INFO    MainThread:391554 [wandb_init.py:init():840] run started, returning control to user process
